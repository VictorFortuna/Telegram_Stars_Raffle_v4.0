# TELEGRAM_WEBAPP
Status: Draft v0.1

## 1. Зачем WebApp
Повышает вовлечённость: живой интерфейс вместо линейных сообщений, более богатый UI.

## 2. Архитектура интеграции
- Бот отправляет кнопку «Открыть игру».
- Пользователь открывает WebApp → передаются initData.
- Бэкенд валидирует сигнатуру initData (по токену бота).

## 3. Функции WebApp (MVP)
- Отображение текущего розыгрыша: статус, фонд, осталось до автозапуска.
- Кнопка «Участвовать».
- Индикация победителя после завершения.
- Ссылка «Проверить честность» (открывает модальное с seed_hash / seed).

## 4. Будущие функции
- История / детали, личная статистика.
- Админ-панель.
- Разные режимы игр.

## 5. Стек фронтенда
Предложение: Vite + React + minimal UI (Styled Components или просто CSS Modules).  
Альтернатива: Svelte (меньше кода). Пока — React стандартнее.

## 6. Коммуникация WebApp ↔ Backend
- REST endpoints:
  - GET /api/raffle/current
  - POST /api/raffle/join
  - GET /api/raffle/fairness/current
  - GET /api/raffle/history?limit=...
- Позже SSE / WebSocket для real-time.

## 7. Аутентификация
- Проверка подписи initData (hash = SHA256(sorted key=value + token)).
- Извлечение user.id → сверка / создание в БД.

## 8. Безопасность
- CORS ограничение (WEBAPP_ALLOWED_ORIGINS).
- Rate limiting (позже).
- Защита от подмены: отклонять запросы без валидной подписи.

## 9. Стратегия обновлений UI
- Семантические версии API.
- Feature toggles (system_settings).

## 10. Переходные этапы
- Шаг 1: Заглушка WebApp (только статус).
- Шаг 2: Участие.
- Шаг 3: Fairness панель.
- Шаг 4: История/статистика.

## 11. TBD
- Выбор дизайна (позже макет).
- Подключение иконок/брендинга.

(Конец файла)
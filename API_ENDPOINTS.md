# Документация API

Этот документ ("контракт") описывает все эндпоинты, доступные на бэкенде.

**Базовый URL:** `/api`

---

### Аутентификация (`/auth`)

#### `POST /auth/telegram`
Аутентифицирует пользователя на основе `initData` от Telegram Mini App.
*   **Защита:** Нет
*   **Тело запроса:**
    ```json
    {
      "initData": "query_id=...&user=...&auth_date=...&hash=..."
    }
    ```
*   **Успешный ответ (200 OK):**
    ```json
    {
      "token": "ey...",
      "user": {
        "id": "123",
        "telegram_id": 123456789,
        "first_name": "Victor",
        "username": "VictorFortuna"
      }
    }
    ```
*   **Ошибка (400 Bad Request):** Невалидные данные.

---

### Ставки (`/bets`)

#### `POST /bets`
Размещает ставку от имени аутентифицированного пользователя в текущем активном розыгрыше.
*   **Защита:** JWT-токен
*   **Тело запроса:** Пустое
*   **Успешный ответ (201 Created):**
    ```json
    {
      "message": "Ставка принята!",
      "bet": {
        "id": "bet_abc",
        "userId": "123",
        "raffleId": "raffle_xyz"
      }
    }
    ```
*   **Ошибка (401 Unauthorized):** Токен не предоставлен или невалиден.
*   **Ошибка (409 Conflict):** Пользователь уже сделал ставку в этом розыгрыше.

---

### Пользователь (`/user`)

#### `GET /user/me`
Возвращает информацию о текущем аутентифицированном пользователе.
*   **Защита:** JWT-токен
*   **Успешный ответ (200 OK):**
    ```json
    {
      "id": "123",
      "telegram_id": 123456789,
      "first_name": "Victor",
      "username": "VictorFortuna",
      "balance": 100
    }
    ```

#### `GET /user/history`
Возвращает историю участий пользователя в розыгрышах.
*   **Защита:** JWT-токен
*   **Успешный ответ (200 OK):**
    ```json
    [
      {
        "raffleId": "raffle_abc",
        "status": "finished",
        "isWinner": true,
        "finishedAt": "2025-08-08T12:00:00Z"
      }
    ]
    ```